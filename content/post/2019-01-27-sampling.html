---
draft: false
title: Sampling uniformly from an embedded Klein bottle
author: ~
date: "2019-01-28"
publishdate: 2019-02-01
slug: uniform-sample-embedded-klein-bottle
categories: [methodology]
tags: [statistical topology,software packages]
---



<pre class="r"><code>knitr::opts_chunk$set(message = FALSE)</code></pre>
<p>Experimenting and practicing with topological data analytic (TDA) tools requires a healthy diversity of suitable data sets. Several real-world classics can be found in various packages, for example the glucose and insulin test data <a href="https://link.springer.com/article/10.1007/BF00423145">collected and analyzed by Reaven and Miller</a> and later <a href="http://diglib.eg.org/handle/10.2312/SPBG.SPBG07.091-100">used by Singh, Carlsson, and Mémoli</a> to illustrate the Mapper construction, which is included in the <strong>heplots</strong> package:</p>
<pre class="r"><code>data(Diabetes, package = &quot;heplots&quot;)
head(Diabetes)</code></pre>
<pre><code>##   relwt glufast glutest instest sspg  group
## 1  0.81      80     356     124   55 Normal
## 2  0.95      97     289     117   76 Normal
## 3  0.94     105     319     143  105 Normal
## 4  1.04      90     356     199  108 Normal
## 5  1.00      90     323     240  143 Normal
## 6  0.76      86     381     157  165 Normal</code></pre>
<p>For purposes of validation and comparison in particular, we need to supplement empirical data sets, which reflect potentially interesting but unknown topological structure, with artificial data sets that have known, and often simple, intrinsic topology. Probably the most commonly used are simulated samples from a circle, which are straightforward to generate in R:</p>
<pre class="r"><code>library(magrittr)
library(tibble)
library(dplyr)
library(ggplot2)
runif(n = 100) %&gt;%
  enframe(name = NULL) %&gt;%
  mutate(theta = 2*pi * value) %&gt;%
  mutate(x = cos(theta), y = sin(theta)) %&gt;%
  mutate_at(vars(x, y), funs(. + rnorm(n = length(.), sd = .1))) %&gt;%
  print() -&gt; circle_sample</code></pre>
<pre><code>## # A tibble: 100 x 4
##     value  theta      x        y
##     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
##  1 0.149  0.936   0.676  0.900  
##  2 0.137  0.863   0.486  0.772  
##  3 0.768  4.83    0.187 -1.05   
##  4 0.194  1.22    0.564  0.892  
##  5 0.0150 0.0941  0.995  0.0449 
##  6 0.829  5.21    0.447 -0.788  
##  7 0.591  3.71   -0.727 -0.561  
##  8 0.986  6.19    1.08  -0.00698
##  9 0.0802 0.504   0.750  0.490  
## 10 0.946  5.94    1.04  -0.276  
## # … with 90 more rows</code></pre>
<pre class="r"><code>circle_sample %&gt;%
  select(x, y) %&gt;%
  ggplot(aes(x = x, y = y)) + coord_fixed() + geom_point()</code></pre>
<p><img src="/post/2019-01-27-sampling_files/figure-html/circle%20sample-1.png" width="672" /></p>
<p>The sampling protocol is typical of TDA:</p>
<ol style="list-style-type: decimal">
<li>Pick a topological property to test for (in this case, a loop, or a non-trivial generator in <span class="math inline">\(H_1(\,\cdot\,,\mathbb{Z})\)</span>).</li>
<li>Choose a manifold <span class="math inline">\(M\)</span> with the desired property (<span class="math inline">\(M=S^1\)</span>).</li>
<li>Choose an embedding <span class="math inline">\(f:M\to\mathbb{R}^m\)</span> of the manifold into a suitable Euclidean space</li>
</ol>
<p>While working with Raoul on <a href="https://github.com/rrrlw/ggtda">the <strong>ggtda</strong> package</a>, i’ve realized both how useful these simple artificial data sets are and how difficult they can be to find or produce. The <strong>TDA</strong> package can <a href="https://rdrr.io/cran/TDA/man/sphereUnif.html">sample uniformly a sphere</a></p>
