---
draft: false
title: comparing pairwise and multivariate correlation networks of binary data
author: ~
date: 2019-08-30
slug: presence-absence
categories: [methodology]
tags: [network analysis,correlation,presence-absence data,finches]
---



<p>A project i’ve had in the works for years, and “almost done” <a href="https://www.siam.org/Conferences/CM/Conference/ns18">since last summer</a>, is a sensitivity and robustness analysis of several techniques used in studies of “comorbidity networks” (also “disease graphs”, “disease maps”, etc.) that have appeared over the past 20 years. As i begin the abstract:</p>
<blockquote>
<p>Comorbidity network analysis (CNA) is an increasingly popular approach in systems medicine, in which mathematical graphs encode epidemiological correlations (links) between diseases (nodes) inferred from their occurrence in an underlying patient population.</p>
</blockquote>
<p>An essential part of this project is a comparison of pairwise versus multivariate network construction. A <strong>pairwise</strong> (or, more generally, “motif-wise”) construction involves aggregating the network from links determined from some measure of association between pairs (or among motifs) of coded disorders. While many such measures are simply defined in terms of data, others, most notably correlation coefficients, are assumed to have latent values that must be estimated from data. In some studies, these estimates control for patient-level covariates such as age, sex, and ethnic group. A <strong>multivariate</strong> construction involves controlling these estimates for <em>other disorders</em>, whose various associations are also being estimated. (Multivariate constructions may but needn’t also control for patient-level covariates.)</p>
<p>To understand the problem of identifying suitable multivariate models, it’s important to know that the underlying data are binary, having the structure of presence–absence data.
<em>Presence–absence data</em> constitute a case–condition matrix <span class="math inline">\(X\in\{0,1\}^{n\times m}\)</span> whose each entry <span class="math inline">\(x_{ij}\in\{0,1\}\)</span> is one if case <span class="math inline">\(i\)</span> satisfies condition <span class="math inline">\(j\)</span> and zero if not. The term “presence–absence” derives from ecology, where the cases and conditions are sites and species and <span class="math inline">\(x_{ij}=1\)</span> indicates that species <span class="math inline">\(j\)</span> was observed at site <span class="math inline">\(i\)</span>.</p>
<p>A variety of binary association measures emerged in earlier ecology studies—check out <a href="https://www.researchgate.net/profile/Zdenek_Hubalek/publication/229695992_Coefficients_of_Association_and_Similarity_Based_on_Binary_Presence-Absence_Data_An_Evaluation/links/5a2e5ef445851552ae7f1ddc/Coefficients-of-Association-and-Similarity-Based-on-Binary-Presence-Absence-Data-An-Evaluation.pdf">the survey and comparison by Hubálek from 1982</a>—and a handful, including the correlation coefficient <span class="math inline">\(\phi\)</span> (A<sub>30</sub>) attributed independently to Yule and to Pearson and Heron and Forbes’ coefficient of association (A<sub>40</sub>), made their way into comorbidity network analysis, together with the odds ratio more widely used in medical research. By and large, these statistics do not generalize to summaries of 3 or more variables; those that do tend to be correlation coefficients.</p>
<div id="multivariate-techniques-for-network-construction" class="section level3">
<h3>multivariate techniques for network construction</h3>
<p>I adopted two multivariate approaches to compare to the pairwise approach: One, which uses partial correlation coefficients, has been introduced in psychology and was the subject of <a href="https://arxiv.org/abs/1607.01367">a 2017 tutorial by Epskamp and Fried</a>. If <span class="math inline">\(m\)</span> variables <span class="math inline">\(y_i\mid 1\leq i\leq m\)</span> have standard deviations <span class="math inline">\(\sigma_i\)</span>, then the <em>full partial correlation</em> of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(y_j\)</span> is the standardized regression coefficient <span class="math inline">\(\displaystyle r&#39;_{ij}=\frac{\sigma_j}{\sigma_i}\beta_{ij}\)</span> from the linear model predicting <span class="math inline">\(y_i\)</span> from all other variables—or, equivalently, <span class="math inline">\(\displaystyle r&#39;_{ji}=\frac{\sigma_i}{\sigma_j}\beta_{ji}\)</span> from the model predicting <span class="math inline">\(y_j\)</span>. The <em>partial correlation network</em> <span class="math inline">\(G&#39;\)</span> is aggregated from the <span class="math inline">\(r&#39;_{ij}\)</span>. Since these correlations are controlled for the effects of other variables, <span class="math inline">\(G&#39;\)</span> should include far fewer <a href="https://terrytao.wordpress.com/2014/06/05/when-is-correlation-transitive/">transitive correlations</a> than a pairwise network.</p>
<p>Conveniently, partial correlations can be calculated from whatever pairwise correlations one begins with.</p>
<p>I also wanted to borrow from the current ecology literature. On my reading, ecology has always been at the cutting edge of multivariate statistical analysis, and lately there have been proposed several correlation and network models to overcome the well-documented limitations of pairwise techniques. These proposals have been motivated by a desire to capture a variety of interactions among species, geography, and environment. The reviews i’ve found aren’t recent enough to have surveyed the most interesting examples, which include <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.2007.0030-1299.16173.x">Ulrich &amp; Gotelli (2007)</a>, <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/10-0173.1">Ovaskainen, Hottola, &amp; Siitonen (2010)</a>, <a href="https://link.springer.com/article/10.1007%2Fs12080-015-0281-9">Cazelles, Araújo, Mouquet, &amp; Gravel (2016)</a>, and <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/ecog.01892">Morueta-Holme et al (2015)</a>.</p>
<p>Mostly because the authors included an tutorial for their method implemented in R in their supporting information, i adopted the <em>joint distribution model</em> (JDM) <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.12180">proposed by Pollock and colleagues</a>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Though the model was developed to handle both variable interactions (“endogenous” effects) and case-level covariates (“exogenous” effects), for this illustration i’m only concerned with endogenous information.</p>
<p>This simplified JDM assumes that each row of a <span class="math inline">\(0,1\)</span>-matrix <span class="math inline">\(X\in\{0,1\}^{n\times m}\)</span> is obtained from a latent multivariate normal distribution with center <span class="math inline">\(\vec\mu=[\,\mu_1\,\cdots\,\mu_m\,]\)</span> and covariance matrix <span class="math inline">\(\Sigma\)</span>. The <span class="math inline">\(\mu_j\)</span> encode the prevalences of the column variables of <span class="math inline">\(X\)</span> while <span class="math inline">\(\Sigma\)</span> encodes their correlations. If <span class="math inline">\(Z\sim N(\vec\mu,\Sigma)\)</span>, then the rows of <span class="math inline">\(X\)</span> are assumed to have been generated from samples <span class="math inline">\(\vec z_i=[\,z_1\,\cdots\,z_m\,]\)</span> as <span class="math display">\[x_{ij}=\begin{cases} 0 &amp; z_{ij}\leq 0 \\ 1 &amp; z_{ij}&gt;0 \end{cases}\text.\]</span> The model is hierarchical with respect to the meta-parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> and is fit using Bayesian methods. I’ll denote the correlation matrix estimated this way as <span class="math inline">\(\hat{\mathrm{P}}=(\hat\rho_{ij})\)</span>, since Pollock and colleagues designate the underlying correlation matrix <span class="math inline">\(\mathrm{P}\)</span> (capital <span class="math inline">\(\rho\)</span>).</p>
<p>In each construction, two variables are linked in the network when their association is both <em>discernible</em> and <em>strong</em>. “Discernibility” has to do with the detection of a statistical signal, and is a cautious substitution for the misleading and often-abused term “significance”. “Strength” has to do with the size of the relative amount by which change in one variable predicts change in the other, assuming the pattern in the data reflects the latent relationship (and would be a better referent for “significance” anyway).</p>
</div>
<div id="a-comparable-pairwise-construction" class="section level3">
<h3>a comparable pairwise construction</h3>
<p>Since partial correlations can be calculated from any sample correlation data, a grand comparison of these three approaches requires only a (pairwise) correlation coefficient that meaningfully compares to <span class="math inline">\(\hat\rho_{ij}\)</span>. The JDM relies on a latent multivariate normal, so a natural choice—once i found it—is a correlation coefficient based on a latent <em>bivariate</em> normal: the <em>tetrachoric correlation coefficient</em>, often denoted <span class="math inline">\(r_t\)</span>.</p>
<p>The setup for <span class="math inline">\(r_t\)</span> is a distribution <span class="math inline">\(N(\mu,\Sigma)\)</span> with means <span class="math inline">\(\vec\mu=[\,\mu_1,\mu_2\,]\)</span> and covariance <span class="math display">\[\Sigma=\left(\begin{array}{cc} \!{\sigma_1}^2\! &amp; \!\rho\sigma_1\sigma_2\! \\ \!\rho\sigma_1\sigma_2\! &amp; \!{\sigma_2}^2\! \end{array}\right)\text.\]</span>
The upshot is that, as in the JDM, the value of the statistic is an estimate of the hidden (latent) correlation coefficient <span class="math inline">\(\rho\)</span>. Several estimation techniques are discussion in <a href="https://www.researchgate.net/publication/313196484_Polychoric_and_polyserial_correlations">Drasgow’s entry for the <em>Encyclopedia of Statistical Sciences</em></a>.</p>
<p>Implementations of all three statistics are available but require a bit of lead-in, so i’ll come back to this topic—and a grand comparison—in a future post.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Pollock and colleagues call this a “joint species distribution model”, but since i’m applying the method outside ecology, and since the structure of the model clarifies which distributions its name refers to, i’m leaving out the qualifier.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
