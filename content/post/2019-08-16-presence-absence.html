---
draft: true
title: i don't like correlation network models of presence--absence data
author: ~
date: 2019-08-30
slug: presence-absence
categories: [methodology]
tags: [network analysis,correlation,presence-absence data,finches]
---



<p>A project i’ve had in the works for years, and “almost done” <a href="https://www.siam.org/Conferences/CM/Conference/ns18">since last summer</a>, is a sensitivity and robustness analysis of several techniques used in studies of “comorbidity networks” (also “disease graphs”, “disease maps”, etc.) that have appeared over the past 20 years. As i begin the abstract:</p>
<blockquote>
<p>Comorbidity network analysis (CNA) is an increasingly popular approach in systems medicine, in which mathematical graphs encode epidemiological correlations (links) between diseases (nodes) inferred from their occurrence in an underlying patient population.</p>
</blockquote>
<p>An essential part of this project is a comparison of pairwise versus multivariate network construction. A <strong>pairwise</strong> (or, more generally, “motif-wise”) construction involves aggregating the network from links determined from some measure of association between pairs (or among motifs) of coded disorders. While many such measures are simply defined in terms of data, others, most notably correlation coefficients, are assumed to have latent values that must be estimated from data. In some studies, these estimates control for patient-level covariates such as age, sex, and ethnic group. A <strong>multivariate</strong> construction involves controlling these estimates for <em>other disorders</em>, whose various associations are also being estimated. (Multivariate constructions may but needn’t also control for patient-level covariates.)</p>
<div id="multivariate-techniques-for-network-construction" class="section level3">
<h3>multivariate techniques for network construction</h3>
<p>I adopted two multivariate approaches to compare to the pairwise approach: One, which uses partial correlation coefficients, has been introduced in psychology and was the subject of <a href="https://arxiv.org/abs/1607.01367">a 2017 tutorial by Epskamp and Fried</a>. If <span class="math inline">\(m\)</span> variables <span class="math inline">\(y_i\mid 1\leq i\leq m\)</span> have standard deviations <span class="math inline">\(\sigma_i\)</span>, then the <em>full partial correlation</em> of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(y_j\)</span> is the standardized regression coefficient <span class="math inline">\(\displaystyle r&#39;_{ij}=\frac{\sigma_j}{\sigma_i}\beta_{ij}\)</span> from the linear model predicting <span class="math inline">\(y_i\)</span> from all other variables—or, equivalently, <span class="math inline">\(\displaystyle r&#39;_{ji}=\frac{\sigma_i}{\sigma_j}\beta_{ji}\)</span> from the model predicting <span class="math inline">\(y_j\)</span>. The <em>partial correlation network</em> <span class="math inline">\(G&#39;\)</span> is aggregated from the <span class="math inline">\(r&#39;_{ij}\)</span>. Since these correlations are controlled for the effects of other variables, <span class="math inline">\(G&#39;\)</span> should include far fewer <a href="">transitive correlations</a> than a pairwise network.</p>
<p>The other multivariate approach i borrowed from the ecology literature. On my reading, ecology has always been at the cutting edge of multivariate statistical analysis, and lately there have been proposed several correlation and network models to overcome the well-documented limitations of pairwise techniques. Mostly because the authors made a tutorial for their method publicly available, i adopted the <em>joint distribution model</em> (JDM) <a href="">proposed by Pollock and colleagues</a>. Though the model was developed to handle both variable interactions (“endogenous” effects) and case-level covariates (“exogenous” effects), for this illustration i’m only concerned with endogenous information.</p>
<p>This simplified JDM assumes that each <span class="math inline">\(i^\text{th}\)</span> row of a <span class="math inline">\(0,1\)</span>-matrix <span class="math inline">\(X\in\{0,1\}^{n\times m}\)</span> is obtained from a latent multivariate normal distribution with center <span class="math inline">\(\vec\mu=[\,\mu_1\,\cdots\,\mu_m\,]\)</span>, whose coordinates are drawn from a normal distribution <span class="math inline">\(\mu_i\sim N(\mu,\sigma)\)</span>, and covariance matrix <span class="math inline">\(\Sigma\)</span>. The <span class="math inline">\(\mu_i\)</span> encode the prevalences of the column variables of <span class="math inline">\(X\)</span> while <span class="math inline">\(\Sigma\)</span> encodes their correlations. The model is hierarchical with respect to the meta-parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> and is fit using Bayesian methods. I’ll denote the correlation matrix estimated this way as <span class="math inline">\(\hat{\mathrm{P}}=(\hat\rho_{ij})\)</span>, since Pollock and colleagues designate the underlying correlation matrix <span class="math inline">\(\mathrm{P}\)</span> (capital <span class="math inline">\(\rho\)</span>).</p>
<p>In each construction, two variables are linked in the network when their association is both <em>discernible</em> and <em>strong</em>. “Discernibility” has to do with the detection of a statistical signal, and is a cautious substitution for the misleading and often-abused term “significance”. “Strength” has to do with the size of the relative amount by which change in one variable predicts change in the other, assuming the pattern in the data reflects the latent relationship (and would be a better referent for “significance” anyway).</p>
</div>
<div id="presenceabsence-data" class="section level3">
<h3>presence–absence data</h3>
<p>Of the models so far described, only the JDM is specifically tailored for a certain kind of data, specifically presence–absence data. <em>Presence–absence data</em> constitute a case–condition matrix <span class="math inline">\(X\in\{0,1\}^{n\times m}\)</span> whose each entry <span class="math inline">\(x_{ij}\in\{0,1\}\)</span> is one if case <span class="math inline">\(i\)</span> satisfies condition <span class="math inline">\(j\)</span> and zero if not. The term “presence–absence” derives from ecology, where the cases and conditions are sites and species and <span class="math inline">\(x_{ij}=1\)</span> indicates that species <span class="math inline">\(j\)</span> was observed at site <span class="math inline">\(i\)</span>.</p>
<p>Since partial correlations can be calculated from any sample correlation data, a grand comparison of these three approaches requires only a correlation coefficient that meaningfully compares to <span class="math inline">\(\hat\rho_{ij}\)</span>. The JDM relies on a latent multivariate normal, so a natural choice is a correlation coefficient based on a latent <em>bivariate</em> normal: the <a href="https://www.researchgate.net/publication/313196484_Polychoric_and_polyserial_correlations"><em>tetrachoric correlation coefficient</em></a>, often denoted <span class="math inline">\(r_t\)</span>.</p>
</div>
